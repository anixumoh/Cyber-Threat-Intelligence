<div class="row">
  <div class="col-6">
    <div class="card mb-0 bg-light">
      <div style="height: 300px">
        <app-map [dataImages]="mapdata" width="100%" height="95%"></app-map>
      </div>
    </div>
  </div>
  <div class="col-3">
    <div class="card" style="height: 300px; overflow-y: auto">
      <ul class="list-group list-group-flush">
        <li class="list-group-item bg-light"><h5 class="mb-0">IPs</h5></li>
        <a
          class="list-group-item list-group-item--sm"
          *ngFor="let ip of ips"
          target="_blank"
          href=""
          routerLink="/dashboard/organizations/{{ this.activeOrganization.id }}/modules/{{
            this.activeModule.id
          }}/threat_context/indicators/ip/resource/{{ ip }}"
        >
          {{ ip }}
        </a>
      </ul>
    </div>
  </div>
  <div class="col-3">
    <div class="card" style="height: 300px; overflow-y: auto">
      <ul class="list-group list-group-flush">
        <li class="list-group-item bg-light"><h5 class="mb-0">Domains</h5></li>
        <a
          class="list-group-item list-group-item--sm"
          *ngFor="let dom of domains"
          target="_blank"
          href="{{ dom.value }}"
        >
          <img src="/assets/images/domainbigdata_logo.svg" class="mr-2" alt="Domain Big Data" height="20" />
          <a
            target="_blank"
            href=""
            routerLink="/dashboard/organizations/{{ this.activeOrganization.id }}/modules/{{
              this.activeModule.id
            }}/threat_context/indicators/fqdn/resource/{{ dom.value }}"
          >
            {{ dom.value }}
          </a>
        </a>
      </ul>
    </div>
  </div>
</div>

<div class="card mt-4" *ngIf="network">
  <div class="card-header">
    <ul class="nav nav-tabs card-header-tabs">
      <li class="nav-item">
        <a class="nav-link" (click)="activeTab = tabs.dns" [ngClass]="{ active: activeTab === tabs.dns }"
          >{{ tabs.dns }} ({{ network && network.dns ? network.dns.length : 0 }})</a
        >
      </li>
      <li class="nav-item">
        <a class="nav-link" (click)="activeTab = tabs.tcp" [ngClass]="{ active: activeTab === tabs.tcp }"
          >{{ tabs.tcp }} ({{ getTCPCount() }})</a
        >
      </li>
      <li class="nav-item">
        <a class="nav-link" (click)="activeTab = tabs.udp" [ngClass]="{ active: activeTab === tabs.udp }"
          >{{ tabs.udp }} ({{ network && network.udp ? network.udp.length : 0 }})</a
        >
      </li>
      <li class="nav-item">
        <a class="nav-link" (click)="activeTab = tabs.http" [ngClass]="{ active: activeTab === tabs.http }"
          >{{ tabs.http }} ({{ getHttpCount() }})</a
        >
      </li>
      <li class="nav-item">
        <a class="nav-link" (click)="activeTab = tabs.icmp" [ngClass]="{ active: activeTab === tabs.icmp }"
          >{{ tabs.icmp }} ({{ network && network.icmp ? network.icmp.length : 0 }})</a
        >
      </li>
      <li class="nav-item">
        <a class="nav-link" (click)="activeTab = tabs.irc" [ngClass]="{ active: activeTab === tabs.irc }"
          >{{ tabs.irc }} ({{ network && network.irc ? network.irc.length : 0 }})</a
        >
      </li>
      <li class="nav-item">
        <a class="nav-link" (click)="activeTab = tabs.smtp" [ngClass]="{ active: activeTab === tabs.smtp }"
          >{{ tabs.smtp }} ({{ network && network.smtp ? network.smtp_ex.length : 0 }})</a
        >
      </li>
    </ul>
  </div>
  <div class="card-body">
    <div class="" *ngIf="activeTab === tabs.dns">
      <app-malware-details-network-dns [data]="network"> </app-malware-details-network-dns>
    </div>

    <div class="" *ngIf="activeTab === tabs.tcp">
      <app-malware-details-network-tcp [data]="network"> </app-malware-details-network-tcp>
    </div>

    <div class="" *ngIf="activeTab === tabs.udp">
      <app-malware-details-network-udp [data]="network"> </app-malware-details-network-udp>
    </div>

    <div class="" *ngIf="activeTab === tabs.http">
      <app-malware-details-network-http [data]="network"> </app-malware-details-network-http>
    </div>

    <div class="" *ngIf="activeTab === tabs.icmp">
      <app-malware-details-network-icmp [data]="network"> </app-malware-details-network-icmp>
    </div>

    <div class="" *ngIf="activeTab === tabs.irc">
      <app-malware-details-network-irc [data]="network"> </app-malware-details-network-irc>
    </div>

    <div class="" *ngIf="activeTab === tabs.smtp">
      <app-malware-details-network-smtp [data]="network"> </app-malware-details-network-smtp>
    </div>
  </div>
</div>
