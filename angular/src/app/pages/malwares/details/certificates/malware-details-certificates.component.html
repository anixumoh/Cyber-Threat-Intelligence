<div>
  <accordion class="">
    <ng-container *ngFor="let item of certificates">
      <div class="card signature-accordion signature-accordion--primary">
        <div class="card-header" (click)="item.accordionOpen = !!!item.accordionOpen">
          <span>{{ item.subject.common_name }}</span>
          <i [ngClass]="{ 'icon-arrow-up': item.accordionOpen, 'icon-arrow-down': !item.accordionOpen }"></i>
        </div>

        <div class="card-body" [ngClass]="{ 'card-body--show': item.accordionOpen }">
          <ng-container *ngIf="item.accordionOpen">
            <table class="table table-sm">
              <tr>
                <td>MD5</td>
                <td>
                  <a
                    *ngIf="item.md5"
                    href="/dashboard/organizations/{{ activeOrganization.id }}/modules/{{
                      activeModule.id
                    }}/threat_context/malwares?dork=ioa.certificates.md5.keyword:%22{{ item.md5 }}%22"
                    >{{ item.md5 }}</a
                  >
                  <span *ngIf="!item.md5">-</span>
                </td>
              </tr>
              <tr>
                <td>SHA-1</td>
                <td>
                  <a
                    *ngIf="item.sha1"
                    href="/dashboard/organizations/{{ activeOrganization.id }}/modules/{{
                      activeModule.id
                    }}/threat_context/malwares?dork=ioa.certificates.sha1.keyword:%22{{ item.sha1 }}%22"
                    >{{ item.sha1 }}</a
                  >
                  <span *ngIf="!item.sha1">-</span>
                </td>
              </tr>
              <tr>
                <td>SHA-256</td>
                <td>
                  <a
                    *ngIf="item.sha256"
                    href="/dashboard/organizations/{{ activeOrganization.id }}/modules/{{
                      activeModule.id
                    }}/threat_context/malwares?dork=ioa.certificates.sha256.keyword:%22{{ item.sha256 }}%22"
                    >{{ item.sha256 }}</a
                  >
                  <span *ngIf="!item.sha256">-</span>
                </td>
              </tr>
              <tr>
                <td>Serial Number</td>
                <td>
                  <a
                    *ngIf="item.serial_number"
                    href="/dashboard/organizations/{{ activeOrganization.id }}/modules/{{
                      activeModule.id
                    }}/threat_context/malwares?dork=ioa.certificates.serial_number.keyword:%22{{
                      item.serial_number
                    }}%22"
                    >{{ item.serial_number }}</a
                  >
                  <span *ngIf="!item.serial_number">-</span>
                </td>
              </tr>
              <tr>
                <td>Signature Algorithm</td>
                <td>
                  <a
                    *ngIf="item.signature_algorithm"
                    href="/dashboard/organizations/{{ activeOrganization.id }}/modules/{{
                      activeModule.id
                    }}/threat_context/malwares?dork=ioa.certificates.signature_algorithm.keyword:%22{{
                      item.signature_algorithm
                    }}%22"
                    >{{ item.signature_algorithm }}</a
                  >
                  <span *ngIf="!item.signature_algorithm">-</span>
                </td>
              </tr>
              <tr>
                <td>X.509 Version</td>
                <td>
                  <a
                    *ngIf="item.version"
                    href="/dashboard/organizations/{{ activeOrganization.id }}/modules/{{
                      activeModule.id
                    }}/threat_context/malwares?dork=ioa.certificates.version.keyword:%22{{ item.version }}%22"
                    >{{ item.version || '-' }}</a
                  >
                  <span *ngIf="!item.version">-</span>
                </td>
              </tr>
              <tr>
                <td>Issued</td>
                <td>
                  <a
                    *ngIf="item.validity.not_before"
                    href="/dashboard/organizations/{{ activeOrganization.id }}/modules/{{
                      activeModule.id
                    }}/threat_context/malwares?dork=ioa.certificates.validity.not_before.keyword:%22{{
                      item.validity.not_before
                    }}%22"
                    >{{ getDate(item.validity.not_before) }}</a
                  >
                  <span *ngIf="!item.validity.not_before">-</span>
                </td>
              </tr>
              <tr>
                <td>Expires</td>
                <td>
                  <a
                    *ngIf="item.validity.not_after"
                    href="/dashboard/organizations/{{ activeOrganization.id }}/modules/{{
                      activeModule.id
                    }}/threat_context/malwares?dork=ioa.certificates.validity.not_after.keyword:%22{{
                      item.validity.not_after
                    }}%22"
                    >{{ getDate(item.validity.not_after) }}</a
                  >
                  <span *ngIf="!item.validity.not_after">-</span>
                </td>
              </tr>
              <tr>
                <td>Common Name</td>
                <td>
                  <div>
                    <a
                      *ngIf="item.subject.common_name"
                      href="/dashboard/organizations/{{ activeOrganization.id }}/modules/{{
                        activeModule.id
                      }}/threat_context/malwares?dork=ioa.certificates.subject.common_name.keyword:%22{{
                        item.subject.common_name
                      }}%22"
                      >{{ item.subject.common_name || '-' }}</a
                    >
                    <span *ngIf="!item.subject.common_name">-</span> (subject)
                  </div>
                  <div>
                    <a
                      *ngIf="item.issuer.common_name"
                      href="/dashboard/organizations/{{ activeOrganization.id }}/modules/{{
                        activeModule.id
                      }}/threat_context/malwares?dork=ioa.certificates.issuer.common_name.keyword:%22{{
                        item.issuer.common_name
                      }}%22"
                      >{{ item.issuer.common_name || '-' }}</a
                    >
                    <span *ngIf="!item.issuer.common_name">-</span> (issuer)
                  </div>
                </td>
              </tr>
              <tr>
                <td>Organization Name</td>
                <td>
                  <div>
                    <a
                      *ngIf="item.subject.organization"
                      href="/dashboard/organizations/{{ activeOrganization.id }}/modules/{{
                        activeModule.id
                      }}/threat_context/malwares?dork=ioa.certificates.subject.organization.keyword:%22{{
                        item.subject.organization
                      }}%22"
                      >{{ item.subject.organization }}</a
                    >
                    <span *ngIf="!item.subject.organization">-</span> (subject)
                  </div>
                  <div>
                    <a
                      *ngIf="item.issuer.organization"
                      href="/dashboard/organizations/{{ activeOrganization.id }}/modules/{{
                        activeModule.id
                      }}/threat_context/malwares?dork=ioa.certificates.issuer.organization.keyword:%22{{
                        item.issuer.organization
                      }}%22"
                      >{{ item.issuer.organization }}</a
                    >
                    <span *ngIf="!item.issuer.organization">-</span> (issuer)
                  </div>
                </td>
              </tr>
              <tr>
                <td>Organizational Unit</td>
                <td>
                  <div>
                    <a
                      *ngIf="item.subject.organizational_unit"
                      href="/dashboard/organizations/{{ activeOrganization.id }}/modules/{{
                        activeModule.id
                      }}/threat_context/malwares?dork=ioa.certificates.subject.organizational_unit.keyword:%22{{
                        item.subject.organizational_unit
                      }}%22"
                      >{{ item.subject.organizational_unit }}</a
                    >
                    <span *ngIf="!item.subject.organizational_unit">-</span> (subject)
                  </div>
                  <div>
                    <a
                      *ngIf="item.issuer.organizational_unit"
                      href="/dashboard/organizations/{{ activeOrganization.id }}/modules/{{
                        activeModule.id
                      }}/threat_context/malwares?dork=ioa.certificates.issuer.organizational_unit.keyword:%22{{
                        item.issuer.organizational_unit
                      }}%22"
                      >{{ item.issuer.organizational_unit }}</a
                    >
                    <span *ngIf="!item.issuer.organizational_unit">-</span> (issuer)
                  </div>
                </td>
              </tr>
              <tr>
                <td>Locality</td>
                <td>
                  <a
                    *ngIf="item.subject.locality"
                    href="/dashboard/organizations/{{ activeOrganization.id }}/modules/{{
                      activeModule.id
                    }}/threat_context/malwares?dork=ioa.certificates.subject.locality.keyword:%22{{
                      item.subject.locality
                    }}%22"
                    >{{ item.subject.locality }}</a
                  >
                  <span *ngIf="!item.subject.locality">-</span>
                </td>
              </tr>
              <tr>
                <td>State/Province</td>
                <td>
                  <div>
                    <a
                      *ngIf="item.subject.state"
                      href="/dashboard/organizations/{{ activeOrganization.id }}/modules/{{
                        activeModule.id
                      }}/threat_context/malwares?dork=ioa.certificates.subject.state.keyword:%22{{
                        item.subject.state
                      }}%22"
                      >{{ item.subject.state }}</a
                    >
                    <span *ngIf="!item.subject.state">-</span> (subject)
                  </div>
                  <div>
                    <a
                      *ngIf="item.issuer.state"
                      href="/dashboard/organizations/{{ activeOrganization.id }}/modules/{{
                        activeModule.id
                      }}/threat_context/malwares?dork=ioa.certificates.issuer.state.keyword:%22{{
                        item.issuer.state
                      }}%22"
                      >{{ item.issuer.state }}</a
                    >
                    <span *ngIf="!item.issuer.state">-</span> (issuer)
                  </div>
                </td>
              </tr>
              <tr>
                <td>Country</td>
                <td>
                  <div>
                    <a
                      *ngIf="item.subject.country"
                      href="/dashboard/organizations/{{ activeOrganization.id }}/modules/{{
                        activeModule.id
                      }}/threat_context/malwares?dork=ioa.certificates.subject.country.keyword:%22{{
                        item.subject.country
                      }}%22"
                      >{{ item.subject.country }}</a
                    >
                    <span *ngIf="!item.subject.country">-</span> (subject)
                  </div>
                  <div>
                    <a
                      *ngIf="item.issuer.country"
                      href="/dashboard/organizations/{{ activeOrganization.id }}/modules/{{
                        activeModule.id
                      }}/threat_context/malwares?dork=ioa.certificates.issuer.country.keyword:%22{{
                        item.issuer.country
                      }}%22"
                      >{{ item.issuer.country }}</a
                    >
                    <span *ngIf="!item.issuer.country">-</span> (issuer)
                  </div>
                </td>
              </tr>
            </table>
          </ng-container>
        </div>
      </div>
    </ng-container>
  </accordion>
</div>
