<style>
  pre {
    /* Make the pre's in this page wrap to the next line instead of having
    to move around with the cursor. */
    white-space: pre-wrap;
  }
</style>

<div class="">
  <ng-container *ngIf="hasSmtp()">
    <app-table [items]="data.smtp_ex" [loading]="false" [sm]="true">
      <thead>
        <tr>
          <th class="td-30">Destination</th>
          <th class="td-30">Port</th>
          <th class="td-30">Mail from</th>
          <th class="td-30">Mail to</th>
          <th class="td-30">Headers</th>
          <th class="td-30">Body</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of data.smtp_ex">
          <td class="td-30">{{ item.dst }}</td>
          <td class="td-30">{{ item.dport }}</td>
          <td class="td-30">
            <span *ngFor="let item of item.req.mail_from">{{ item }}</span>
          </td>
          <td class="td-30">
            <span *ngFor="let item of item.req.mail_to">{{ item }}</span>
          </td>
          <td class="td-30">
            <div *ngFor="let item of item.req.headers | keyvalue">
              <strong style="font-weight: bold; color: #000000b3">{{ item.key }}</strong
              >: {{ item.value }}
            </div>
          </td>
          <td class="td-30">
            <button
              *ngIf="item.req.mail_body; else na"
              (click)="openCloseModal(item.req.mail_body)"
              class="btn btn-sm btn-circle ml-3"
            >
              <i class="icon-info text-primary" style="font-size: 20px"></i>
            </button>
            <ng-template #na>N/A</ng-template>
          </td>
        </tr>
      </tbody>
    </app-table>
  </ng-container>
  <!-- NO RESULTS DATA -->
  <ng-container *ngIf="!hasSmtp()">
    <div class="no-results-box bg-light">
      <img src="assets/default_images/searching.svg" />
      <h4 class="no-results">No SMTP connections have been found</h4>
    </div>
  </ng-container>
</div>

<modal-window
  modalTitle="Body info"
  *ngIf="bodyModal"
  cancelBtn="Close"
  [closeBtn]="true"
  (cancel)="openCloseModal('')"
  customClass="modal-dark-web"
>
  <div class="padding-10 pt-3 pb-4" [innerText]="bodyInfo"></div>
</modal-window>
