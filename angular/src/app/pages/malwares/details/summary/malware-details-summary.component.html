<div class="row">
  <div class="col col-xxl-4">
    <div class="card mb-3">
      <div class="card-body">
        <div class="space-between">
          <div class="font-size--header text-truncate">
            <span *ngIf="!toolId">{{ malwareType }}</span>
            <a [routerLink]="getRedirectToToolsLink()" *ngIf="toolId">{{ malwareType }}</a>
          </div>
          <div><i class="icon-bug text-primary" style="font-size: 2em"></i></div>
        </div>
        <div class="text--underline text-muted text-upercase">VERSION/NAME: {{ version }} / {{ versionName }}</div>
      </div>
    </div>

    <div class="card mb-3">
      <div class="card-body">
        <div class="space-between">
          <div class="font-size--header">{{ cerberus }}</div>
          <div><i class="icon-users text-primary" style="font-size: 2em"></i></div>
        </div>
        <div class="text--underline text-muted text-upercase">Signatures: {{ signatures }}</div>
      </div>
    </div>

    <app-flush-list [data]="entries" mode="bold"></app-flush-list>

    <div class="row" *ngIf="istcctiplabs">
      <div class="col">
        <button type="button" class="btn btn-outline-primary btn-sm btn-block" (click)="loadAnalysisLogs()">
          Analysis
        </button>
      </div>
      <div class="col">
        <button type="button" class="btn btn-outline-danger btn-sm btn-block" (click)="loadErrorLogs()">Errors</button>
      </div>
    </div>
  </div>
  <div class="col col-xxl-8">
    <div class="card mb-3" *ngIf="match">
      <div class="card-body" style="padding: 0">
        <table class="table text-center" style="margin: 0">
          <thead>
            <tr>
              <th scope="col">Target</th>
              <th scope="col">Unpacked</th>
              <th scope="col">Dropped</th>
              <th scope="col">Buffers</th>
              <th scope="col">malfind</th>
              <th scope="col">Proc.Mem</th>
              <th scope="col">Memory</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center">
                <i
                  [ngClass]="{ 'icon-close text-danger': !match.target, 'icon-check text-success': match.target }"
                  class="fa"
                ></i>
              </td>
              <td class="text-center">
                <i
                  [ngClass]="{ 'icon-close text-danger': !match.unpacked, 'icon-check text-success': match.unpacked }"
                  class="fa"
                ></i>
              </td>
              <td class="text-center">
                <i
                  [ngClass]="{ 'icon-close text-danger': !match.dropped, 'icon-check text-success': match.dropped }"
                  class="fa"
                ></i>
              </td>
              <td class="text-center">
                <i
                  [ngClass]="{ 'icon-close text-danger': !match.buffers, 'icon-check text-success': match.buffers }"
                  class="fa"
                ></i>
              </td>
              <td class="text-center">
                <i
                  [ngClass]="{ 'icon-close text-danger': !match.malfind, 'icon-check text-success': match.malfind }"
                  class="fa"
                ></i>
              </td>
              <td class="text-center">
                <i
                  [ngClass]="{
                    'icon-close text-danger': !match.procmemory,
                    'icon-check text-success': match.procmemory
                  }"
                  class="fa"
                ></i>
              </td>
              <td class="text-center">
                <i
                  [ngClass]="{ 'icon-close text-danger': !match.memory, 'icon-check text-success': match.memory }"
                  class="fa"
                ></i>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <app-malware-details-summary-crimeservers
      [crimeservers]="crimeservers"
      [orgId]="activeOrganization?.id"
      [moduleId]="activeModule?.id"
    ></app-malware-details-summary-crimeservers>

    <app-malware-details-summary-sources
      *ngIf="malwareId"
      [orgId]="activeOrganization?.id"
      [moduleId]="activeModule?.id"
      (seenDates)="seenDatesUpdate($event)"
    ></app-malware-details-summary-sources>
  </div>

  <app-modal title="Analysis Logs" [show]="showModal" class="modal-lg" (close)="closeModal()">
    <div class="modal-content">
      <div class="modal-header bg-light">
        <h5 class="modal-title mb-0 pull-left">{{ modalData.title }}</h5>
        <button type="button" class="close pull-right" (click)="closeModal()" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre class="bg-light border rounded p-3">{{ modalData.content }}</pre>
      </div>
      <div class="modal-footer clearfix">
        <button type="button" class="btn btn-outline-danger float-right" (click)="closeModal()">Close</button>
      </div>
    </div>
  </app-modal>
</div>
