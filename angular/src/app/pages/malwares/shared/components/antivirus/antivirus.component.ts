import {Component, Input, OnInit} from '@angular/core';


@Component({
  selector: 'app-malware-details-static-antivirus',
  templateUrl: './antivirus.component.html'
})
export class MalwareStaticAV implements OnInit {

  @Input() antivirus;

  public data = [];

  constructor() {
  }

  ngOnInit() {
    if (Object.keys(this.antivirus).length > 0) {
      this.prepareData();
    }
  }

  private prepareData() {
    let scans = this.antivirus.scans;
    if (this.antivirus.hasOwnProperty('tar')) {
      scans = this.antivirus.tar;
    }
    for (let vendor in scans) {
      if  (scans[vendor]) {
        this.data.push({
            'vendor': vendor,
            'result': scans[vendor]['result']
          });
      }
    }
  }
}

