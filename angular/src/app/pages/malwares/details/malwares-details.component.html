<app-overlay [loading]="loading">
  <div class="mb-5">
    <h6 class="text-muted text-uppercase text-90 font-weight-bold mb-0 tcx-section-name">MALWARE DETAIL</h6>
    <div class="flex--center">
      <h5 class="card-title mb-0 malware-title tcx-resource-name">{{ malwareId }}</h5>
      <div style="display: flex; align-items: center">
        <a class="ml-1 mr-1" target="_blank" href="{{ virustotalUrl }}">
          <img
            src="/assets/images/virustotal.png"
            class="rounded border border-primary button-virustotal"
            alt="VirusTotal"
          />
        </a>

        <div class="button-action mr-1" ngbDropdown>
          <button
            ngbDropdownToggle
            class="btn btn-light btn-sm border text-primary width-85 float-left btn-actions"
            type="button"
            id="actionsButtonDropdown"
            name="button"
          >
            Export
          </button>
          <div ngbDropdownMenu class="actions-dropdown-menu padding-0 border-0">
            <ul aria-labelledby="actionsButtonDropdown" class="list-group actions-menu shadow border rounded font-14">
              <li
                class="list-group-item list-group-item-action cursor-pointer border-0 px-3 py-2"
                (click)="exportToCSV()"
              >
                <i class="icon-share-square mr-2"></i>
                <span>CSV</span>
              </li>
              <li
                class="list-group-item list-group-item-action cursor-pointer border-0 px-3 py-2"
                (click)="exportToJson()"
              >
                <i class="icon-share-square mr-2"></i>
                <span>JSON</span>
              </li>
            </ul>
          </div>
        </div>

        <button
          class="btn btn-light btn-sm border text-primary mr-1"
          *ngIf="!notFound && !serverError"
          (click)="downloadPcap()"
        >
          PCAP
        </button>
        <a
          class="btn btn-light btn-sm border text-primary mr-1"
          *ngIf="!notFound && !serverError"
          routerLink="/dashboard/organizations/{{ organizationId }}/modules/{{
            this.moduleId
          }}/threat_context/indicators/malware/resource/{{ malwareId }}"
        >
          Indicators View
        </a>

        <button type="button" class="btn btn-light btn-sm border text-primary" (click)="backToList()">
          Back to list
        </button>
      </div>
    </div>

    <div class="line mt-1"></div>

    <div *ngIf="!notFound && !serverError">
      <div class="card-tab mb-2" style="padding-top: 0">
        <ul class="nav nav-pills border-bottom">
          <li
            class=""
            *ngFor="let tab of tabs"
            role="presentation"
            [routerLink]="tab.link"
            [queryParams]="queryParams"
            routerLinkActive="is-active"
          >
            <span *ngIf="tab.icon" class="{{ tab.icon }}"></span> {{ tab.name }}
          </li>
        </ul>
      </div>
      <router-outlet></router-outlet>
    </div>

    <div class="empty" *ngIf="notFound || serverError">
      <div><img src="/assets/default_images/searching.svg" alt="" /></div>
      <div class="empty__text" *ngIf="notFound">The malware detail is not available at the moment.</div>
      <div class="empty__text" *ngIf="serverError">The malware detail is not available at the moment.</div>
    </div>
  </div>
</app-overlay>
