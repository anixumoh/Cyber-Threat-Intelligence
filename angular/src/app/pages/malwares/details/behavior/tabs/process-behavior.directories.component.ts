import {Component, Input, OnChanges, OnInit, SimpleChanges} from '@angular/core';

@Component({
  selector: 'app-malware-details-process-behavior-directories',
  templateUrl: './process-behavior.directories.component.html'
})
export class MalwareProcessBehaviorDirectories implements OnInit, OnChanges {

  @Input() data;

  private directories = {};
  private dataRender = [];
  private selectedFilter = ["created", "removed", "enumerated"];

  constructor() {
  }

  ngOnInit() {
  }

  ngOnChanges(changes: SimpleChanges) {
    if (changes.hasOwnProperty('data')) {
      this.dataRender = [];
      this.directories = changes['data']['currentValue'];
      this.prepareData();
    }
  }

  private prepareData() {
    this.dataRender = [];
    for (let key in this.directories) {
      if (this.selectedFilter.indexOf(key) > -1) {
        for (let dir of this.directories[key]) {
          let item = {
            access: key,
            file: dir
          };
          this.dataRender.push(item);
        }
      }
    }
  }

  private setAccessColor(accessType) {
    let out = "badge badge-success";
    if (accessType == "created") {
      out = "badge badge-danger";
    }
    if (accessType == "deleted") {
      out = "badge badge-warning";
    }
    if (accessType == "opened") {
      out = "badge badge-warning";
    }
    if (accessType == "exists") {
      out = "badge badge-info";
    }
    return out;
  }

  private onFilterEvent(event) {
    this.selectedFilter = event;
    this.prepareData();
  }

}


