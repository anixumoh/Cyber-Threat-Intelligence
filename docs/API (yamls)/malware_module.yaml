# This is the new CTIP API
swagger: '2.0'
info:
  title: CTIP MALWARE API
  description: API for the MALWARE module
  version: "1.0.0"
host: new-ui-pre.blueliv.com
schemes:
  - https
basePath: /api/v2
consumes:
  - application/json
produces:
  - application/json
paths:
  /organization/{organizationId}/module/{moduleId}/malware/resource:
#GET -> Get a paginable list of resources
    get:
      summary: List resources
      description: Get a paginable list of resources
      parameters:
        - name: x-cookie
          in: header
          description: Authorization token
          required: true
          type: string
        - name: organizationId
          in: path
          description: Organization id
          required: true
          type: integer
        - name: moduleId
          in: path
          description: Module id
          required: true
          type: integer
        - name: page
          in: query
          description: Page
          required: false
          type: integer
        - name: maxRows
          in: query
          description: Max rows
          required: false
          type: integer
        - name: since
          in: query
          description: Since date in milliseconds
          required: false
          type: integer
          format: int64
        - name: to
          in: query
          description: To date in milliseconds
          required: false
          type: integer
          format: int64
        - name: analysisCalcResult
          in: query
          description: Analysis Result
          required: false
          type: string
        - name: labels
          in: query
          description: Labels
          required: false
          type: string
        - name: read
          in: query
          description: 0 - Both, 1 - Only read, 2 - Only unread
          required: false
          type: integer
        - name: starred
          in: query
          description: Show only starred resources (true)
          required: false
          type: string  
        - name: q
          in: query
          description: Key word for search
          required: false
          type: string        
      tags:
        - List
      responses:
        200:
          description: JSON containing a list of resources
          schema:
            type: object
            properties:
              total_resources:
                type: integer
                format: int32
              list:
                type: array
                items:
                  title: Malware
                  type: object
                  properties:
                    email:
                      type: boolean
                    employee:
                      type: boolean
                    customer:
                      type: boolean
                    external:
                      type: boolean
                    tlpStatus:
                      type: string
                    credentials:
                      type: array
                      items:
                        title: Credential
                        type: object
                        properties:
                          id:
                            type: string
                          userName: 
                            type: string
                          userPassword:
                            type: string
                          portalUrl:
                            type: string
                          botIp:
                            type: string
                          type:
                            type: string
                          isEmail:
                            type: boolean
                          reportedAt:
                            type: string
                            format: date-time
                            pattern: YYYY-MM-DDThh:mm:ssZ
                          classification:
                            type: string
                          infectionPeriod:
                            type: object
                            properties:
                              id:
                                type: string
                              start:
                                type: string
                                format: date-time
                                pattern: YYYY-MM-DDThh:mm:ssZ
                              end:
                                type: string
                                format: date-time
                                pattern: YYYY-MM-DDThh:mm:ssZ
                          stolenData:
                            type: object
                            properties:
                              stolenAt:
                                type: string
                                format: date-time
                                pattern: YYYY-MM-DDThh:mm:ssZ
                              botLongitude:
                                type: number
                                format: double
                              botLatitude:
                                type: number
                                format: double
                              botCity:
                                type: string
                              botCountry:
                                type: string
                              botCountryName:
                                type: string
                              botIp:
                                type: string
                
          examples: 
            application/json: 
             {
                "total_resources": 1,
                "list": [
                           {
                              email: false,
                              employee: false,
                              customer: false,
                              external: false,
                              id: 243636323,
                              title: "xxxx.yyy",
                              created_at: 1485734400,
                              checked_at: 1485734400,
                              changed_at: 1485734400,
            
                              credentials: [
                                  {
                                    id: 19837,
                                    userName: "xxxx",
                                    userPassword: "yyyy",
                                    portalUrl: "www.google.es",
                                    botIp: "",
                                    type: "",
                                    isEmail: "false",
                                    reportedAt: 1485734400,
                                    classification: "",
                                    infectionPeriod: {
                                      id: "",
                                      start: 1485734400,
                                      end: 1485734400
                                    },
                                    stolenData: {
                                      stolenAt: 1485734400,
                                      botLongitude: 41,
                                      botLatitude:  2,
                                      botCity: "City",
                                      botCountry: "CO",
                                      botCountryName: "Country",
                                      botIp: ""
                                    }
            
                                  }
                                ],
                                tlpStatus: "AMBER"
                            }
                    ]
              }
             
        400:
          description: Bad Request
          schema:
            $ref: '#/definitions/Error'
# DELETE -> Delete resources
    delete:
      summary: Delete
      description: Delete resources
      parameters:
        - name: x-cookie
          in: header
          description: Authorization token
          required: true
          type: string
        - name: organizationId
          in: path
          description: Organization id
          required: true
          type: integer
        - name: moduleId
          in: path
          description: Module id
          required: true
          type: integer
        - name: object
          in: body
          required: true
          schema:
            $ref: '#/definitions/ResourceList'
      tags:
        - Utils
      responses:    
        200:
          description: Resources succesfully deleted
          schema:
            $ref: '#/definitions/Success'
        400:
          description: Bad Request
          schema:
            $ref: '#/definitions/Error'

  /organization/{organizationId}/module/{moduleId}/malware/resource/{resourceId}/tlpStatus/{status}:
#PUT -> Sets a new TLP status
    put:
      summary: Set TLP
      description: Sets a new TLP status
      parameters:
        - name: x-cookie
          in: header
          description: Authorization token
          required: true
          type: string
        - name: organizationId
          in: path
          description: Organization id
          required: true
          type: integer
        - name: moduleId
          in: path
          description: Module id
          required: true
          type: integer
        - name: resourceId
          in: path
          description: Resource id
          required: true
          type: integer
        - name: status
          in: path
          description: New TLP status
          required: true
          type: integer

      tags:
        - Utils
      responses:    
        200:
          description: Mark as no read succesfully
          schema:
            $ref: '#/definitions/Success'
        400:
          description: Bad Request
          schema:
            $ref: '#/definitions/Error'


  /organization/{organizationId}/module/{moduleId}/malware/resource/markAs:
#PUT -> Mark resources as read/unread
    put:
      summary: Mark as
      description: Mark resources as read or no read
      parameters:
        - name: x-cookie
          in: header
          description: Authorization token
          required: true
          type: string
        - name: organizationId
          in: path
          description: Organization id
          required: true
          type: integer
        - name: moduleId
          in: path
          description: Module id
          required: true
          type: integer
        - name: object
          in: body
          required: true
          schema:
            $ref: '#/definitions/MarkAsObject'
      tags:
        - Utils
      responses:    
        200:
          description: Mark as no read succesfully
          schema:
            $ref: '#/definitions/Success'
        400:
          description: Bad Request
          schema:
            $ref: '#/definitions/Error'

  /organization/{organizationId}/module/{moduleId}/malware/resource/rating:
#PUT -> Rate a resource
    put:
      summary: Rating
      description: Set new rating for the resources
      parameters:
        - name: x-cookie
          in: header
          description: Authorization token
          required: true
          type: string
        - name: organizationId
          in: path
          description: Organization id
          required: true
          type: integer
        - name: moduleId
          in: path
          description: Module id
          required: true
          type: integer
        - name: object
          in: body
          required: true
          schema:
            $ref: '#/definitions/RatingObject'
      tags:
        - Utils
      responses:    
        200:
          description: Rating saved correctly
          schema:
            $ref: '#/definitions/Success'
        400:
          description: Bad Request
          schema:
            $ref: '#/definitions/Error'

  /organization/{organizationId}/module/{moduleId}/malware/resource/fav:
#PUT -> Mark a resource as favorite
    put:
      summary: Favorite
      description: Mark a resource as favorite
      parameters:
        - name: x-cookie
          in: header
          description: Authorization token
          required: true
          type: string
        - name: organizationId
          in: path
          description: Organization id
          required: true
          type: integer
        - name: moduleId
          in: path
          description: Module id
          required: true
          type: integer
        - name: object
          in: body
          required: true
          schema:
            $ref: '#/definitions/FavObject'
      tags:
        - Utils
      responses:    
        200:
          description: Resource favorited succesfully
          schema:
            $ref: '#/definitions/Success'
        400:
          description: Bad Request
          schema:
            $ref: '#/definitions/Error'
            

  /organization/{organizationId}/module/{moduleId}/malware/resource/{resourcesId}/issue/{issueId}:
# DELETE -> Remove an issue from resource
    delete:
      summary: Issue
      description: Remove issue from resources
      parameters:
        - name: x-cookie
          in: header
          description: Authorization token
          required: true
          type: string
        - name: organizationId
          in: path
          description: Organization id
          required: true
          type: integer
        - name: moduleId
          in: path
          description: Module id
          required: true
          type: integer
        - name: resourcesId
          in: path
          description: Resource id
          required: true
          type: integer
        - name: issueId
          in: path
          description: Issue id
          required: true
          type: integer
      tags:
        - Utils
      responses:    
        200:
          description: Issue removed succesfully
          schema:
            $ref: '#/definitions/Success'
        400:
          description: Bad Request
          schema:
            $ref: '#/definitions/Error'


  /organization/{organizationId}/module/{moduleId}/malware/resource/{resourceId}/issue:
# GET -> Get issue list by resource id
    get:
      summary: Detail
      description: Get list of issues
      parameters:
        - name: x-cookie
          in: header
          description: Authorization token
          required: true
          type: string
        - name: organizationId
          in: path
          description: Organization id
          required: true
          type: integer
        - name: moduleId
          in: path
          description: Module id
          required: true
          type: integer
        - name: resourceId
          in: path
          description: Resource id
          required: true
          type: integer
      tags:
        - List
      responses:    
        200:
          description: JSON contaning list of issues
          schema:
            title: List
            type: array
            items:
              type: object
              properties:
                id:
                  type: integer
                title:
                  type: string
                description:
                  type: string
                typeId:
                  type: string
                remediationTips:
                  type: string
                status:
                  type: string
                risk:
                  type: string
                activities:
                  type: integer
                module_id:
                  type: integer
                organitazion_id:
                  type: integer
                creation_date:
                  type: string
                  format: date-time
                  pattern: YYYY-MM-DDThh:mm:ssZ
                checked_at:
                  type: string
                  format: date-time
                  pattern: YYYY-MM-DDThh:mm:ssZ
                notification_date:
                  type: string
                  format: date-time
                  pattern: YYYY-MM-DDThh:mm:ssZ
                lastUpdateUser:
                  type: string
                reputationalSearchId: #Module Id
                  type: integer
                superSearchId: #Organization Id
                  type: integer
                searchType:
                  type: string
                labels:
                  type: array
                  items:
                    type: object
                    properties:
                      id:
                        type: integer
                      name:
                        type: string
                      type:
                        type: string
                    
          examples: 
            application/json: 
              [
                {
                  id: 1,
                  title: "",
                  description: "",
                  typeId: "",
                  remediationTips: "",
                  status: "",
                  risk: "",
                  activities: 0,
                  creation_date: 1485734400,
                  changed_at: 1485734400,
                  notification_date: 1485734400,
                  last_update_user: "",
                  reputationalSearchId: 0,
                  superSearchId: 0,
                  labels: [
                      {
                          id: 15412,
                          name: "incident",
                          type: "GLOBAL"
                      }
                  ]
                }
              ]
        400:
          description: Bad Request
          schema:
            $ref: '#/definitions/Error'

  /organization/{organizationId}/module/{moduleId}/malware/resource/issue/list:
# GET -> Get issue list by module id
    get:
      summary: Detail
      description: Get list of issues
      parameters:
        - name: x-cookie
          in: header
          description: Authorization token
          required: true
          type: string
        - name: organizationId
          in: path
          description: Organization id
          required: true
          type: integer
        - name: moduleId
          in: path
          description: Module id
          required: true
          type: integer
      tags:
        - List
      responses:    
        200:
          description: JSON contaning list of issues
          schema:
            title: List
            type: array
            items:
              type: object
              properties:
                value:
                  type: string
                label:
                  type: string
          examples: 
            application/json: 
              [
                {
                  "value": "6",
                  "label": "Test issue"
                },
                {
                  "value": "1",
                  "label": "Stolen credentials"
                }
              ]
        400:
          description: Bad Request
          schema:
            $ref: '#/definitions/Error'

  /organization/{organizationId}/module/{moduleId}/malware/resource/{resourceId}/issue/types:
# GET -> Get issue types
    get:
      summary: Detail
      description: Get list of types of issues
      parameters:
        - name: x-cookie
          in: header
          description: Authorization token
          required: true
          type: string
        - name: organizationId
          in: path
          description: Organization id
          required: true
          type: integer
        - name: moduleId
          in: path
          description: Module id
          required: true
          type: integer
        - name: resourceId
          in: path
          description: Resource id
          required: true
          type: integer
      tags:
        - List
      responses:    
        200:
          description: JSON contaning list of types
          schema:
            title: List
            type: array
            items:
              type: object
              properties:
                label:
                  type: string
                value:
                  type: string
          examples: 
            application/json: 
              [
                {
                  value: "type1",
                  label: "Type 1"
                }
              ]
        400:
          description: Bad Request
          schema:
            $ref: '#/definitions/Error'            

  /organization/{organizationId}/module/{moduleId}/malware/resource/label:
#PUT -> Assign a label to resources
    put:
      summary: Label
      description: Assign a label to resources
      parameters:
        - name: x-cookie
          in: header
          description: Authorization token
          required: true
          type: string
        - name: organizationId
          in: path
          description: Organization id
          required: true
          type: integer
        - name: moduleId
          in: path
          description: Module id
          required: true
          type: integer
        - name: object
          in: body
          required: true
          schema:
            $ref: '#/definitions/LabelObject'
      tags:
        - Utils
      responses:    
        200:
          description: Label assigned succesfully
          schema:
            $ref: '#/definitions/Success'
        400:
          description: Bad Request
          schema:
            $ref: '#/definitions/Error'
    get:
      summary: Label list
      description: Get label list by organizationId and moduleId
      parameters:
        - name: x-cookie
          in: header
          description: Authorization token
          required: true
          type: string
        - name: organizationId
          in: path
          description: Organization id
          required: true
          type: integer
        - name: moduleId
          in: path
          description: Module id
          required: true
          type: integer
      tags:
        - Utils
      responses:    
        200:
          description: Label list
          schema:
            $ref: '#/definitions/LabelList'
        400:
          description: Bad Request
          schema:
            $ref: '#/definitions/Error'

  /organization/{organizationId}/module/{moduleId}/malware/resource/{resourceId}:
# GET -> Get detailed information from a specific resource
    get:
      summary: Detail
      description: Get detailed information from a specific resource
      parameters:
        - name: x-cookie
          in: header
          description: Authorization token
          required: true
          type: string
        - name: organizationId
          in: path
          description: Organization id
          required: true
          type: integer
        - name: moduleId
          in: path
          description: Module id
          required: true
          type: integer
        - name: resourceId
          in: path
          description: Resource id
          required: true
          type: integer
      tags:
        - List
      responses:    
        200:
          description: JSON contaning detailed information of a the resource
          schema:
            title: Detailed object
            type: object
            items:
              title: Details
              type: object
              properties:
                info:
                  title: Index
                  type: object
                  properties:
                    category:
                      type: string
                    started:
                      type: string
                      format: date-time
                      pattern: YYYY-MM-DDThh:mm:ssZ
                    ended:
                      type: string
                      format: date-time
                      pattern: YYYY-MM-DDThh:mm:ssZ
                    version:
                      type: string
                    duration:
                      type: integer
                    id:
                      type: integer
                network:
                  title: Network
                  type: object
                  properties:
                    udp:
                      type: array
                      items:
                        type: object
                        properties:
                          dport:
                            type: integer
                          src:
                            type: string
                          dst:
                            type: string
                          sport:
                            type: integer
                    http:
                      type: array
                      items:
                        type: object
                        properties:
                          body:
                            type: string
                          uri:
                            type: string
                          user-agent:
                            type: string
                          port:
                            type: integer
                          host:
                            type: string
                          version:
                            type: string
                          path:
                            type: string
                          data:
                            type: string
                          method:
                            type: string
                    tcp:
                      type: array
                      items:
                        type: object
                        properties:
                          dport:
                            type: integer
                          src:
                            type: string
                          dst:
                            type: string
                          sport:
                            type: integer
                    hosts:
                      type: array
                      items:
                        type: string
                    pcap_sha256:
                      type: string
                    dns:
                      type: array
                      items:
                        type: object
                        properties:
                          request:
                            type: string
                          type:
                            type: string
                          answers:
                            type: array
                            items:
                              type: object
                              properties:
                                type:
                                  type: string
                                data:
                                  type: string
                    domains:
                      type: array
                      items:
                        type: object
                        properties:
                          ip:
                            type: string
                          domain:
                            type: string
                remove:
                  type: boolean
                static:
                  type: object
                  properties:
                    pe_imports:
                      type: array
                      items:
                        type: object
                        properties:
                          imports:
                            type: array
                            items:
                              type: object
                              properties:
                                name:
                                  type: string
                                address:
                                  type: string
                          dll:
                            type: string
                    peid_signatures:
                      type: string
                    pe_exports:
                      type: array
                    imported_dll_count:
                      type: integer
                    pe_resources:
                      type: array
                    pe_versioninfo:
                      type: array
                    pe_section:
                      type: array
                      items:
                        type: object
                        properties:
                          size_of_data:
                            type: string
                          virtual_address:
                            type: string
                          entropy:
                            type: number
                            format: float
                          name:
                            type: string
                          virtual_size:
                            type: string
                behavior:
                  type: object
                  properties:
                    processes:
                      type: string
                    processtree:
                      type: array
                      items:
                        type: object
                        properties:
                          pid:
                            type: string
                          name:
                            type: string
                          children:
                            type: array
                    summary:
                      type: object
                      properties:
                        files:
                          type: array
                          items:
                            type: string
                        keys:
                          type: array
                          items:
                            type: string
                        mutexes:
                          type: array
                          items:
                            type: string
                target:
                  type: object
                  properties:
                    category:
                      type: string
                    file:
                      type: array
                      items:
                        type: object
                        properties:
                          yara:
                            type: array
                          sha1:
                            type: string
                          name:
                            type: string
                          sha512:
                            type: string
                          crc32:
                            type: string
                          path:
                            type: string
                          ssdeep:
                            type: string
                          sha256:
                            type: string
                          type:
                            type: string
                          md5:
                            type: string
                          size: 
                            type: number
                debug:
                  type: object
                  properties:
                    error:
                      type: array
                    log:
                      type: string
                signature:
                  type: object
                  properties:
                    families:
                      type: array
                    description:
                      type: string
                    name:
                      type: string
                    alert:
                      type: boolean
                    references:
                      type: array
                    data:
                      type: array
                    severity:
                      type: integer
                blueliv:
                  type: object
                  properties:
                    memory_strings:
                      type: array
                      items:
                        type: string
                    memory_process_strings_volatility:
                      type: array
                      items:
                        type: object
                        properties:
                          process:
                            type: number
                          string:
                            type: array
                            items:
                              type: string
                    malware_properties:
                      type: array
                dropped:
                  type: array
                  items:
                    type: object
                    properties:
                      yara:
                        type: array
                      sha1:
                        type: string
                      name:
                        type: string
                      sha512:
                        type: string
                      crc32:
                        type: string
                      path:
                        type: string
                      ssdeep:
                        type: string
                      sha256:
                        type: string
                      type:
                        type: string
                      md5:
                        type: string
                      size: 
                        type: number
                report_version:
                  type: integer
                
          examples: 
            application/json: 
              {
                  "info": {
                      "category": "file",
                      "started": "2013-07-27 09:36:13",
                      "ended": "2013-07-27 09:38:58",
                      "version": "0.6",
                      "duration": 165,
                      "id": 8258
                  },
                  "network": {
                      "udp": [
                          {
                              "dport": 53,
                              "src": "192.168.56.102",
                              "dst": "8.8.8.8",
                              "sport": 1050
                          }
                      ],
                      "http": [
                          {
                              "body": "",
                              "uri": "http://dwninfo.ru/get_xml?file_id=32050993&did=237467408",
                              "user-agent": "tiny-dl/nix",
                              "port": 80,
                              "host": "dwninfo.ru",
                              "version": "1.1",
                              "path": "/get_xml?file_id=32050993&did=237467408",
                              "data": "GET /get_xml?file_id=32050993&did=237467408 HTTP/1.1\r\nAccept: */*\r\nUser-Agent: tiny-dl/nix\r\nHost: dwninfo.ru\r\n\r\n",
                              "method": "GET"
                          }
                      ],
                      "smtp": [],
                      "tcp": [
                          {
                              "dport": 80,
                              "src": "192.168.56.102",
                              "dst": "78.140.165.153",
                              "sport": 1051
                          }
                      ],
                      "hosts": [
                          "192.168.56.102"
                      ],
                      "pcap_sha256": "16524257de60f5113958987fad3d9dc88e09d134a332a90c535d3659213911a9",
                      "dns": [
                          {
                              "request": "dwninfo.ru",
                              "type": "A",
                              "answers": []
                          }
                      ],
                      "domains": [
                          {
                              "ip": "78.140.165.153",
                              "domain": "dwninfo.ru"
                          }
                      ],
                      "irc": []
                  },
                  "remove": true,
                  "static": {
                      "pe_imports": [
                          {
                              "imports": [
                                  {
                                      "name": "CloseHandle",
                                      "address": "0x41d154"
                                  }
                              ],  
                              "dll": "KERNEL32.dll"
                          },
                          {
                              "imports": [
                                  {
                                      "name": "_write",
                                      "address": "0x41d1e0"
                                  }
                              ],
                              "dll": "msvcrt.dll"
                          },
                          {
                              "imports": [
                                  {
                                      "name": "__getmainargs",
                                      "address": "0x41d1e8"
                                  }
                              ],
                              "dll": "msvcrt.dll"
                          }
                      ],
                      "peid_signatures": null,
                      "pe_exports": [],
                      "imported_dll_count": 3,
                      "pe_resources": [],
                      "pe_versioninfo": [],
                      "pe_sections": [
                          {
                              "size_of_data": "0x9600",
                              "virtual_address": "0x1000",
                              "entropy": 6.190225126113634,
                              "name": ".text",
                              "virtual_size": "0x95b4"
                          }
                      ]
                  },
                  "behavior": {
                      "processes": [],
                      "processtree": [
                          {
                              "pid": 1624,
                              "name": "minecraft_v_1_5_1_2012_pc_portable_skachat_igry_cherez_torrent_-.exe",
                              "children": []
                          }
                      ],
                      "summary": {
                          "files": [
                              "C:\\Documents and Settings\\b\\Configuraci\\xc3\\xb3n local\\Archivos temporales de Internet",
                              "C:\\Documents and Settings\\b\\Configuraci\\xc3\\xb3n local\\Historial"
                          ],
                          "keys": [
                                  "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\P3P\\History\\rutor.net"
                          ],
                          "mutexes": [
                              "_!MSFTHISTORY!_",
                              "c:!documents and settings!b!configuraci\\xc3\\xb3n local!archivos temporales de internet!content.ie5!",
                              "c:!documents and settings!b!cookies!",
                              "c:!documents and settings!b!configuraci\\xc3\\xb3n local!historial!history.ie5!",
                              "WininetStartupMutex",
                              "WininetConnectionMutex",
                              "WininetProxyRegistryMutex",
                              "CTF.TimListCache.FMPDefaultS-1-5-21-1409082233-746137067-1343024091-1003MUTEX.DefaultS-1-5-21-1409082233-746137067-1343024091-1003"
                          ]
                      }
                  },
                  "target": {
                      "category": "file",
                      "file": {
                          "yara": [],
                          "sha1": "9282b6350977e95bc543ce2bbd51aeb4f4cb3afd",
                          "name": "minecraft_v_1_5_1_2012_pc_portable_skachat_igry_cherez_torrent_-.exe",
                          "sha512": "b209bceeee6c9f7ba70336111b43b483b6cdf0b2b88719f35c2bbcf9e90e09c2702f6e27cb37e1c6247a3cb23651e60ac4d9318e1d04853c949d960eabaeebc0",
                          "crc32": "329066B8",
                          "path": "/home/mwlbot/cuckoo/storage/binaries/1273f39d0d8007e549d76a56181d626a760ad62e20d45ae391566f8d0bf153e6",
                          "ssdeep": "3072:OjwLbJTbvyUROx+BkLucnaOXiu6hTZoqUgxsQ:OjwLbJTG8+ha8iugoqUgyQ",
                          "sha256": "1273f39d0d8007e549d76a56181d626a760ad62e20d45ae391566f8d0bf153e6",
                          "type": "PE32 executable (GUI) Intel 80386 (stripped to external PDB), for MS Windows",
                          "md5": "9a679cc02905f9ec06e8717003b0f637",
                          "size": 122776
                      }
                  },
                  "debug": {
                      "errors": [],
                      "log": "2013-07-12 12:03:10,880 [root] INFO: Starting analyzer from: C:\\suxshfudm\n2013-07-12 12:03:10,890 [root] INFO: Storing results at: C:\\qbxfbbt\n2013-07-12 12:03:10,890 [root] INFO: Pipe server name: \\\\.\\PIPE\\nmhzwknzvt\n2013-07-12 12:03:10,890 [root] INFO: No analysis package specified, trying to detect it automagically\n2013-07-12 12:03:10,890 [root] INFO: Automatically selected analysis package \"exe\"\n2013-07-12 12:03:11,010 [lib.api.process] INFO: Successfully executed process from path \"C:\\DOCUME~1\\b\\CONFIG~1\\Temp\\minecraft_v_1_5_1_2012_pc_portable_skachat_igry_cherez_torrent_-.exe\" with arguments \"None\" with pid 1624\n2013-07-12 12:03:11,020 [lib.api.process] INFO: Using QueueUserAPC injection\n2013-07-12 12:03:11,020 [lib.api.process] INFO: Successfully injected process with pid 1624\n2013-07-12 12:03:13,023 [lib.api.process] INFO: Successfully resumed process with pid 1624\n2013-07-12 12:03:13,023 [root] INFO: Added new process to list with pid: 1624\n2013-07-12 12:03:13,084 [root] INFO: Added new file to list with path: c:\\autoexec.bat\n2013-07-12 12:03:13,184 [root] INFO: Added new file to list with path: C:\\Documents and Settings\\b\\Cookies\\b@dwninfo[1].txt\n2013-07-12 12:05:12,214 [root] INFO: Analysis timeout hit, terminating analysis\n2013-07-12 12:05:12,214 [root] INFO: Analysis completed\n"
                  },
                  "signatures": [
                      {
                          "families": [],
                          "description": "The sample installs itself to autorun at Windows startup to asure the persistence in the infected machine in every system restart",
                          "name": "Persistence",
                          "alert": false,
                          "references": [],
                          "data": [],
                          "severity": 1
                      }
                  ],
                  "blueliv": {
                      "memory_strings": [
                          "                            <partner_new_url><![CDATA[http://dwninfo.ru/software_install?guid=$__GUID&sig=$__SIG&hsig=$__HWSIG&file_id=32050993&did=237467408]]></partner_new_url>"
                      ],
                      "memory_process_strings_volatility": [
                          {
                              "process": 1092,
                              "strings": []
                          }
                      ],
                      "malware_properties": []
                  },
                  "dropped": [
                      {
                          "yara": [],
                          "content": "",
                          "sha1": "f8cb42e0371773111e1e91d92a910c406c5e243f",
                          "sha256": "6b3fdfb12702f5fe889ad8b6298700279bb03ce581bb574c6a121bace13c1e81",
                          "sha512": "75d4c61d9511cebe5a044a6e24cb29b5c9d586d7b60ac4d5d5aee54afe1cd2a68cc03317b0684e420ea7d67c6a6905901afc20d927a1b38eb069efba95ca63aa",
                          "md5": "287eaa2bc632e41d5d4345efad44f6d6",
                          "name": "b@dwninfo[1].txt",
                          "type": "ASCII text",
                          "crc32": "8EF7972D",
                          "path": "/home/mwlbot/cuckoo/storage/analyses/8258/files/9896942655/b@dwninfo[1].txt",
                          "ssdeep": "3:GP8quwDAVZ4YQAgUSUjWVWsdBEZUn:4nTLA0ChU",
                          "size": 94
                      }
                  ],
                  "report_version": "1.0"
              }
        400:
          description: Bad Request
          schema:
            $ref: '#/definitions/Error'

  /organization/{organizationId}/module/{moduleId}/malware/resource/{resourceId}/metadata:
    get:
      summary: Metadata
      description: Get metadata header information from a specific resource
      parameters:
        - name: x-cookie
          in: header
          description: Authorization token
          required: true
          type: string
        - name: organizationId
          in: path
          description: Organization id
          required: true
          type: integer
        - name: moduleId
          in: path
          description: Module id
          required: true
          type: integer
        - name: resourceId
          in: path
          description: Resource id
          required: true
          type: integer
      tags:
        - List
      responses:    
        200:
          description: JSON contaning metadata of a the resource
          schema:
            title: Detailed object
            type: object
            items:
              title: Details
              type: object
              properties:
                _id:
                  type: string
                fileMD5:
                  type: string
                fileSHA1:
                  type: string
                fileSHA256:
                  type: string
                sampleFileContentType:
                  type: string
                priority:
                  type: string
                sampleSize:
                  type: integer
                sampleFileName:
                  type: string
                createdAt:
                  type: string
                  format: date-time
                  pattern: YYYY-MM-DDThh:mm:ssZ
                updatedAt:
                  type: string
                  format: date-time
                  pattern: YYYY-MM-DDThh:mm:ssZ
                deliveredAt:
                  type: string
                  format: date-time
                  pattern: YYYY-MM-DDThh:mm:ssZ
                status:
                  type: string
                duration:
                  type: integer
                severity:
                  type: integer
                firstUpload:
                  type: string
                  format: date-time
                  pattern: YYYY-MM-DDThh:mm:ssZ
                lastUpload:
                  type: string
                  format: date-time
                  pattern: YYYY-MM-DDThh:mm:ssZ
                sourceType:
                  type: array
                  items:
                    type: string
                sourceName:
                  type: array
                  items:
                    type: string
                sourceId:
                  type: array
                  items:
                    type: string
                sourceFileName:
                  type: array
                  items:
                    type: string
                sourceCreatedAt:
                  type: array
                  items:
                    type: string
                    format: date-time
                    pattern: YYYY-MM-DDThh:mm:ssZ
                sourceTrackback:
                  type: array
                  items:
                    type: string
                sourceSearchKeywork:
                  type: array
                  items:
                    type: string
                sourceUrl:
                  type: array
                  items:
                    type: string
                sourceUrlIp:
                  type: array
                  items:
                    type: string
                sourceUrlCountry:
                  type: array
                  items:
                    type: string
                sourceUrlCountryName:
                  type: array
                  items:
                    type: string
                sourceUrlLongitude:
                  type: array
                  items:
                    type: number
                    format: double
                sourceUrlLatitude:
                  type: array
                  items:
                    type: number
                    format: double
                sourceUrlCity:
                  type: array
                  items:
                    type: string
                sourceUrlLocation:
                  type: array
                  items:
                    type: string
                sourceUrlLocationGH2:
                  type: array
                  items:
                    type: string
                sourceUrlLocationGH3:
                  type: array
                  items:
                    type: string
                sourceUrlLocationGH4:
                  type: array
                  items:
                    type: string
                sourceUrlLocationGH5:
                  type: array
                  items:
                    type: string
                sourceUrlLocationGH6:
                  type: array
                  items:
                    type: string
                sourceUrlLocationGH7:
                  type: array
                  items:
                    type: string
                sourceUrlLocationGH8:
                  type: array
                  items:
                    type: string
                hostIpLocation:
                  type: array
                  items:
                    type: string
                hostIpLocationGH2:
                  type: array
                  items:
                    type: string
                hostIpLocationGH3:
                  type: array
                  items:
                    type: string
                hostIpLocationGH4:
                  type: array
                  items:
                    type: string
                hostIpLocationGH5:
                  type: array
                  items:
                    type: string
                hostIpLocationGH6:
                  type: array
                  items:
                    type: string
                hostIpLocationGH7:
                  type: array
                  items:
                    type: string
                hostIpLocationGH8:
                  type: array
                  items:
                    type: string
                hostIpLatitude:
                  type: array
                  items:
                    type: string
                hostIpLongitude:
                  type: array
                  items:
                    type: string
                hostIpCountry:
                  type: array
                  items:
                    type: string
                hostIpCountryName:
                  type: array
                  items:
                    type: string
                hostIpCity:
                  type: array
                  items:
                    type: string
                hostIp:
                  type: array
                  items:
                    type: string
                analizedAt:
                  type: string
                  format: date-time
                  pattern: YYYY-MM-DDThh:mm:ssZ
                reportFieldId:
                  type: string
                firstNameType:
                  type: string
                firstSourceType:
                  type: string
                hosts:
                  type: array
                  items:
                    type: string
                sources:
                  type: array
                  items:
                    type: string
                oldData:
                  type: boolean
          examples: 
            application/json: 
              {
                  "_id": "1273f39d0d8007e549d76a56181d626a760ad62e20d45ae391566f8d0bf153e6",
                  "fileMD5": "9a679cc02905f9ec06e8717003b0f637",
                  "fileSHA1": "9282b6350977e95bc543ce2bbd51aeb4f4cb3afd",
                  "fileSHA256": "1273f39d0d8007e549d76a56181d626a760ad62e20d45ae391566f8d0bf153e6",
                  "sampleFileContentType": "application/octet-stream",
                  "priority": "LOWEST",
                  "sampleSize": 122776,
                  "sampleFileName": "minecraft_v_1_5_1_2012_pc_portable_skachat_igry_cherez_torrent_-.exe",
                  "createdAt": "2013-07-15T12:30:47+0000",
                  "updatedAt": "2013-07-15T12:30:47+0000",
                  "deliveredAt": "2013-07-27T07:46:05+0000",
                  "status": "FINISHED_SUCCESSFULLY",
                  "duration": 0,
                  "severity": 0,
                  "firstUpload": "2013-07-15T12:30:47+0000",
                  "lastUpload": "2013-07-15T12:30:47+0000",
                  "sourceType": [
                      "OPEN_SOURCE_FEED"
                  ],
                  "sourceName": [
                      ""
                  ],
                  "sourceId": [
                      ""
                  ],
                  "sourceFileName": [
                      "minecraft_v_1_5_1_2012_pc_portable_skachat_igry_cherez_torrent_-.exe"
                  ],
                  "sourceCreatedAt": [
                      "2013-07-15T12:30:47+0000"
                  ],
                  "sourceTrackback": [
                      ""
                  ],
                  "sourceSearchKeyword": [
                      ""
                  ],
                  "sourceUrl": [
                      "http://dls4.download-file.ru/output/wuvfqqsehlvgx1hfv14fq0qevlrfbklcxq5xwf1ublhvda3d3d/01/e9/0f/31/torrent/0e/27/77/10/minecraft_v_1_5_1_2012_pc_portable_skachat_igry_cherez_torrent_-.exe"
                  ],
                  "sourceUrlIp": [
                      ""
                  ],
                  "sourceUrlCountry": [
                      ""
                  ],
                  "sourceUrlCountryName": [
                      ""
                  ],
                  "sourceUrlLongitude": [
                      1000.0
                  ],
                  "sourceUrlLatitude": [
                      1000.0
                  ],
                  "sourceUrlCity": [
                      ""
                  ],
                  "sourceUrlLocation": [
                      "0 0"
                  ],
                  "sourceUrlLocationGH2": [
                      ""
                  ],
                  "sourceUrlLocationGH3": [
                      ""
                  ],
                  "sourceUrlLocationGH4": [
                      ""
                  ],
                  "sourceUrlLocationGH5": [
                      ""
                  ],
                  "sourceUrlLocationGH6": [
                      ""
                  ],
                  "sourceUrlLocationGH7": [
                      ""
                  ],
                  "sourceUrlLocationGH8": [
                      ""
                  ],
                  "hostIpLocation": [
                      "-122.0838 37.386",
                      "5.75 52.5",
                      "100.0 60.0",
                      "36.2527 49.9808"
                  ],
                  "hostIpLocationGH2": [
                      "9q",
                      "u1",
                      "y4",
                      "ub"
                  ],
                  "hostIpLocationGH3": [
                      "9q9",
                      "u1k",
                      "y4x",
                      "ubc"
                  ],
                  "hostIpLocationGH4": [
                      "9q9h",
                      "u1k4",
                      "y4xj",
                      "ubcu"
                  ],
                  "hostIpLocationGH5": [
                      "9q9ht",
                      "u1k4d",
                      "y4xj7",
                      "ubcu2"
                  ],
                  "hostIpLocationGH6": [
                      "9q9htv",
                      "u1k4dv",
                      "y4xj7d",
                      "ubcu2f"
                  ],
                  "hostIpLocationGH7": [
                      "9q9htvv",
                      "u1k4dv7",
                      "y4xj7d9",
                      "ubcu2fw"
                  ],
                  "hostIpLocationGH8": [
                      "9q9htvvm",
                      "u1k4dv74",
                      "y4xj7d9v",
                      "ubcu2fwr"
                  ],
                  "hostIpLatitude": [
                      37.386,
                      52.5,
                      60.0,
                      49.9808
                  ],
                  "hostIpLongitude": [
                      -122.0838,
                      5.75,
                      100.0,
                      36.2527
                  ],
                  "hostIpCountry": [
                      "US",
                      "NL",
                      "RU",
                      "UA"
                  ],
                  "hostIpCountryName": [
                      "United States",
                      "Netherlands",
                      "Russia",
                      "Ukraine"
                  ],
                  "hostIpCity": [
                      "Mountain View",
                      "",
                      "",
                      "Kharkiv"
                  ],
                  "hostIp": [
                      "8.8.8.8",
                      "78.140.165.153",
                      "217.69.133.27",
                      "188.190.120.50"
                  ],
                  "analyzedAt": "2013-07-27T07:46:05+0000",
                  "reportFileId": "54230e07e4b092d57927b739",
                  "firstNameType": "",
                  "firstSourceType": "OPEN_SOURCE_FEED",
                  "hosts": [],
                  "sources": [],
                  "oldData": true
              }
        400:
          description: Bad Request
          schema:
            $ref: '#/definitions/Error'

  /organization/{organizationId}/module/{moduleId}/malware/resource/upload:
# POST -> Post a file
    post:
      consumes: ['multipart/form-data']
      summary: File upload
      description: Upload a malware
      parameters:
        - name: x-cookie
          in: header
          description: Authorization token
          required: true
          type: string
        - name: organizationId
          in: path
          description: Organization id
          required: true
          type: integer
        - name: moduleId
          in: path
          description: Module id
          required: true
          type: integer
        - name: fileInput
          in: formData
          description: |
            This should be `text/plain` looking like this:
              ```
              700000000170
              700000001668
              700000002284
              <etc...>
              ```
          type: file
          required: true
        - name: filename
          description: File name
          in: formData
          type: string
          required: true
        - name: type
          description: file -> for file upload. url -> for url upload
          in: formData
          type: string
          required: true
      tags:
        - Upload
      responses:    
        200:
          description: Upload status and file md5
          schema:
            type: object
            properties:
              md5:
                type: string
              sha256:
                type: string
              module_id:
                type: integer
              organization_id:
                type: integer
              platform_type:
                type: string
              filename:
                type: string
              file_size:
                type: integer
              upload_date:
                type: string
                format: date-time
                pattern: YYYY-MM-DDThh:mm:ssZ
              status:
                type: string
          examples: 
            application/json: 
              {
                "md5": "b3c7031bc65c28c2340302065e7d00d3",
                "sha256": "f3020a3922efd6626c2fff45695d527f34a8020e938a49292561f18ad1320b59",
                "module_id": 2,
                "organization_id": 1,
                "platform_type": "WINDOWS",
                "filename": "jce_policy-8.zip",
                "file_size": 8409,
                "upload_date": "Feb 13, 2017 5:01:07 PM",
                "status": "UPLOAD_PENDING"
              }
        400:
          description: Bad Request
          schema:
            $ref: '#/definitions/Error'
  /organization/{organizationId}/module/{moduleId}/malware/resource/upload/{md5}:
# GET -> Post a file
    get:
      summary: File upload status
      description: Status of uploaded file
      parameters:
        - name: x-cookie
          in: header
          description: Authorization token
          required: true
          type: string
        - name: organizationId
          in: path
          description: Organization id
          required: true
          type: integer
        - name: moduleId
          in: path
          description: Module id
          required: true
          type: integer
        - name: md5
          in: path
          type: string
          required: true
          description: md5 id of a file
      tags:
        - Upload
      responses:    
        200:
          description: Upload status and file md5
          schema:
            type: object
            properties:
              pending:
                type: string
              resource:
                type: object
                properties:
                  resource_id:
                    type: string
                  organization_id:
                    type: string
                  module_id:
                    type: integer
          examples: 
            application/json: 
              {
                "pending": false,
                "resource": {
                  "resource_id": 730,
                  "organization_id": 1,
                  "module_id": 2
                }
              }
        400:
          description: Bad Request
          schema:
            $ref: '#/definitions/Error'


definitions:
  Error:
    type: object
    properties:
      code:
        type: integer
        format: int32
      message:
        type: string
      fields:
        type: string
  Success:
    type: object
    properties:
      code:
        type: integer
        format: int32
      message:
        type: string
      fields:
        type: string
  Resource:
    type: string
    description: Resource ID
  ResourceList:
    type: array
    items:
      $ref: '#/definitions/Resource'
    example:
      application/json:
        ["1","2","3"]
  MarkAsObject:
    type: object
    properties:
      value:
        type: boolean
        description: true to mark as read, false to mark as unread
      resources:
        $ref: '#/definitions/Resource'
    example:
      application/json:
        {
          "read": true,
          "resources": ["1","2","3"]
        }
  RatingObject:
    type: object
    properties:
      value:
        type: integer
        format: int32
        description: Value from 1 to 5
      resources:
        $ref: '#/definitions/Resource'
    example:
      application/json:
        {
          "rate": 5,
          "resource": "1"
        }
  FavObject:
    type: object
    properties:
      value:
        type: string
        description: Favorite type (NOT_STARRED, USER_STARRED, GROUP_STARRED, FULL_STARRED)
      resource:
        type: integer
        format: int64
        description: Resource id
    example:
      application/json:
        {
          "status": "NOT_STARRED",
          "resource": "1"
        }
  LabelObject:
    type: object
    properties:
      label:
        type: integer
        description: Label ID
      resources:
        $ref: '#/definitions/Resource'
    example:
      application/json:
        {
          "label": labelId,
          "resources": ["1","2","3"]
        }
  LabelList:
    type: array
    items:
      type: object
      properties:
        id:
          type: integer
        label:
          type: string
        background_color:
          type: integer
          format: int64
        text_color:
          type: integer
          format: int64
        organization_id:
          type: integer
        module_id:
          type: integer
    example:
      application/json:
        [
            {
                "id": 1,
                "label": "gmail.com",
                "background_color": 8421504,
                "text_color": 16777215,
                "organization_id": 1,
                "module_id": 1
            },
            {
                "id": 2,
                "label": "Hacktivism Credentials",
                "background_color": 16777215,
                "text_color": 0,
                "organization_id": 1,
                "module_id": 1
            }
        ]