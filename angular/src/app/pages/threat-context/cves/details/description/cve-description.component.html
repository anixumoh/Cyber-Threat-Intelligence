<div class="col-md-12 col-lg-12" *ngIf="model">
  <div class="card-section mb-4 mt-4" *ngIf="model.description">
    <div class="card">
      <div class="card-body">
        <div class="overflow-auto max-h-36">
          <p class="text-justify" [innerHTML]="model.description"></p>
        </div>
      </div>
    </div>
  </div>
  <div class="card-section mb-4" *ngIf="model.platforms && model.platforms.length > 0">
    <h4>Affected Platforms</h4>
    <ng2-smart-table [settings]="cpeSettings" [source]="model.platforms"></ng2-smart-table>
  </div>
  <div
    class="card-section mb-4"
    style="width: 100%; overflow: auto"
    *ngIf="model.exploits && model.exploits.length > 0"
  >
    <h4>Exploits</h4>
    <ng2-smart-table [settings]="exploitSettings" [source]="model.exploits"></ng2-smart-table>
  </div>
  <div class="card-section mb-4" *ngIf="model.references && model.references.length > 0">
    <p>
      <button
        type="button"
        (click)="collapseReferences.toggle()"
        class="btn btn-outline-primary mb-3"
        [attr.aria-expanded]="isCollapsed"
        aria-controls="collapseExample"
      >
        References
        <i class="icon-large ml-2 icon-arrow-down"></i>
      </button>
    </p>
    <div #collapseReferences="ngbCollapse" [ngbCollapse]="!isCollapsed">
      <div class="card">
        <div class="card-body">
          <div class="mb-4">
            <ul style="list-style-type: disc" class="ml-6">
              <li *ngFor="let reference of model.references">
                {{ reference.type }}:
                <a href="{{ reference.url }}" target="_blank">
                  {{ reference.url }}
                </a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
