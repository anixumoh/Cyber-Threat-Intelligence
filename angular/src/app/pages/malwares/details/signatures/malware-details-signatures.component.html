<div class="" *ngFor="let severity of severities">
  <div class="card signature-accordion" [ngClass]="getSeverityColor(severity.level)">
    <div class="card-header" (click)="severity.accordionOpen = !!!severity.accordionOpen">
      <span>{{ severity.name }} ({{ signatureList[severity.key] ? signatureList[severity.key].length : 0 }})</span>
      <i
        [ngClass]="{
          'icon-arrow-up': severity.accordionOpen,
          'icon-arrow-down': !severity.accordionOpen
        }"
      ></i>
    </div>

    <div class="card-body" [ngClass]="{ 'card-body--show': severity.accordionOpen }">
      <ul class="list-group list-group-flush">
        <li class="list-group-item" *ngFor="let sig of signatureList[severity.key]">
          <h5>{{ sig.name }}</h5>
          <p class="text-dark" *ngIf="sig.name !== 'Signed executable'">
            {{ sig.description }}
          </p>
          <p class="text-dark" *ngIf="sig.name === 'Signed executable'">
            The analyzed sample is signed.
            <span>
              The certificate details can be seen in the
              <a href="" [routerLink]="getCertificatesLink()">Certificates tab</a>
            </span>
          </p>

          <div
            [innerHTML]="prettyPrintMarks(sig.marks)"
            *ngIf="sig.name !== 'Signed executable'"
            class="text-dark"
          ></div>
        </li>
      </ul>
    </div>
  </div>
</div>
