<!-- INFO -->
<div class="border rounded p-2 mb-2">
  <details-header *ngIf="resource?.header"
                  [headerData]="headerData"
                  [resource]="resource.header">
  </details-header>
</div>
<!-- SECTIONS -->
<div class="card card-border-primary mb-2" *ngIf="type == 'exe'">
  <div class="card-header bg-light clearfix">
    <h6 class="mb-0">Sections</h6>
  </div>
  <div class="card-body p-2">
    <!-- NO RESULTS -->
    <div *ngIf="!(sections.length > 0)" class="no-results-box">
        <img src="assets/default_images/searching.svg"/>
        <h3 class="no-results">There are no Sections for this sample</h3>
    </div>
    <!-- TABLE -->
    <table class="table" *ngIf="sections.length > 0">
      <thead>
        <tr>
          <th class="align-middle">Name</th>
          <th class="align-middle text-center">Virtual address</th>
          <th class="align-middle text-center">Virtual size</th>
          <th class="align-middle text-center">Data size</th>
          <th class="align-middle text-center">Entropy</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of sections">
          <td class="align-middle">
            <p class="text-secondary mb-0">{{ item.name?.length ? item.name : '-' }}</p>
          </td>
          <td class="align-middle text-center">
            <p class="text-secondary mb-0">{{ item.virtual_address?.length ? item.virtual_address : '-' }}</p>
          </td>
          <td class="align-middle text-center">
            <p class="text-secondary mb-0">{{ item.virtual_size?.length ? item.virtual_size : '-' }}</p>
          </td>
          <td class="align-middle text-center">
            <p class="text-secondary mb-0">{{ item.size_of_data?.length ? item.size_of_data : '-' }}</p>
          </td>
          <td class="align-middle text-center">
            <p class="text-secondary mb-0">{{ item.entropy?.length ? item.entropy : '-' }}</p>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- IMPORTS -->
<div [ngSwitch]="type">
  <div *ngSwitchCase="'zip'" class="list-compressed-files">
    <div class="title-middleline margin-bottom-20">
      <h3 >Compressed Files</h3>
    </div>
    <div class="row">
      <div class="col-md-6">
        <ul *ngIf="(compressedFileContents && (compressedFileContents.length > 0))">
          <li *ngFor="let file of compressedFileContents">
            <span>{{file.name}}</span>
            <button *ngIf="file.vtLink"
              class="btn btn-primary btn-xs pull-right"
              (click)="navigateToUrl(file.vtLink)">
              {{file.vtRatio}}
            </button>
          </li>
        </ul>
      </div>
    </div>
    <div *ngIf="(!compressedFileContents || !(compressedFileContents.length > 0))" class="no-results-box">
      <img src="assets/default_images/searching.svg"/>
      <h3 class="no-results">There is no ZIP report for this sample</h3>
    </div>
  </div>
  <!-- IMPORTS -->
  <div class="card card-border-primary mb-2" *ngSwitchCase="'exe'">
    <div class="card-header bg-light clearfix">
      <h6 class="mb-0" *ngIf="type == 'exe'">Imports</h6>
    </div>
    <div class="card-body p-2">
      <!-- NO RESULTS -->
      <div *ngIf="!(sections.length > 0)" class="no-results-box">
        <img src="assets/default_images/searching.svg"/>
        <h3 class="no-results">There are no Sections for this sample</h3>
      </div>
      <!-- TABS VERTICAL -->
      <app-generic-vertical-tab class="vertical-tabs"
                                [content]='imports'
                                [tabsTitle]="'DLL'"
                                [contentTitle]="'Api calls'"
                                (onSelectEmitter)="selectImport($event)">
                                <div class="border-top" *ngIf='contentChild'>
                                  <ul class="list-group scrollable-div">
                                    <li class="list-group-item border-0 py-2 px-3"
                                        *ngFor="let item of contentChild">
                                        {{item.name}}
                                    </li>
                                  </ul>
                                </div>
      </app-generic-vertical-tab>
    </div>
  </div>
  <!-- OFFICE -->
  <div class="card card-border-primary mb-2" *ngSwitchCase="'office'">
    <div class="card-header bg-light clearfix">
      <h6 class="mb-0">Macros</h6>
    </div>
    <div class="card-body p-2">
      <!-- TABS VERTICAL -->
      <app-generic-vertical-tab class="vertical-tabs"
                                [content]='macros'
                                [tabsTitle]="'Filename'"
                                [contentTitle]="'Macros'"
                                (onSelectEmitter)="selectMacros($event)">
                                <header class=' module-title' *ngIf='contentChild'>
                                  <h4><b>Stream:</b> {{contentChild.stream}}</h4>
                                </header>
                                <article class="vertical-tabs__content section-col col-md-10 organization-columns" *ngIf='contentChild'>
                                  <div class='col-md-6 organization-padding'>
                                    <h4>Original code</h4>
                                    <pre>{{contentChild.orig_code}}</pre>
                                  </div>
                                  <div class='col-md-6 organization-padding'>
                                    <h4>Deobfuscated code</h4>
                                    <pre>{{contentChild.deobf}}</pre>
                                  </div>
                                </article>
      </app-generic-vertical-tab>
    </div>
  </div>
  <!-- CHANGES -->
  <div class="card card-border-primary mb-2" *ngIf="changes">
    <div class="card-header bg-light clearfix">
      <h6 class="mb-0" >Changes</h6>
    </div>
    <div class="card-body p-2" *ngSwitchCase="'pdf'">
      <div  *ngIf="changes || contentChildPdfString">
        <p *ngIf="contentChildPdfString; else tmpl1">
          {{contentChildPdfString}}
        </p>
        <ng-template #tmpl1>
          <app-generic-vertical-tab class="vertical-tabs"
                                    *ngIf="changes"
                                    [content]='changes'
                                    [tabsTitle]="'Change'"
                                    [contentTitle]="'Information'"
                                    (onSelectEmitter)="selectPdf($event)">
                                    <span *ngIf='contentChildPdf'>
                                      <ul class='list-group list-group-flush'>
                                        <li class="list-group-item" *ngFor='let field of listKeys'>
                                          {{contentChildPdf[field.key]}}
                                        </li>
                                      </ul>
                                      <div class='urls' *ngIf="contentChildPdf.urls && (contentChildPdf.urls.length > 0)">
                                        <h4>
                                          URLS
                                        </h4>
                                        <ul>
                                          <li *ngFor="let url of contentChildPdf.urls">
                                            {{url}}
                                          </li>
                                        </ul>
                                      </div>
                                      <div class='javascripts' *ngIf='contentChildPdf.javascript && (contentChildPdf.javascript.length > 0)'>
                                        <div class="module-title">
                                          <h3>
                                            Javascripts
                                          </h3>
                                        </div>
                                        <pre *ngFor='let js of contentChildPdf.javascript'>
                                          {{js.orig_code}}
                                        </pre>
                                      </div>
                                    </span>
          </app-generic-vertical-tab>
        </ng-template>
      </div>
    </div>
  </div>
</div>
